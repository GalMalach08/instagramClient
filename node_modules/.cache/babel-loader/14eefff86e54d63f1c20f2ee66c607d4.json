{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\\\u05DE\\u05DC\\u05D0\\u05DA \\u05D2\\u05DC\\\\Desktop\\\\Projects\\\\Instagram-master\\\\client\\\\src\\\\components\\\\profile\\\\Profile.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react'; // Components\n\nimport ProfileImageModal from '../profileImageModal/ProfileImageModal';\nimport EditProfile from '../editProfile/EditProfile';\nimport Loader from '../loader/Loader'; // Material ui\n\nimport { Grid } from '@material-ui/core';\nimport SettingsIcon from '@material-ui/icons/Settings';\nimport FavoriteIcon from '@material-ui/icons/Favorite';\nimport ChatBubbleRoundedIcon from '@material-ui/icons/ChatBubbleRounded'; // Cloudinary\n\nimport { Image } from 'cloudinary-react'; // Css\n\nimport './style.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst Profile = props => {\n  _s();\n\n  const id = props.match.params.id;\n  const [userProfile, setUserProfile] = useState('');\n  const [posts, setPosts] = useState('');\n  const [imageModal, setImageModal] = useState(true);\n  const [modal, setModal] = useState(false);\n  const [modalImage, setModalImage] = useState('');\n  const [isAllowEdit, setisAllowEdit] = useState(false);\n  const [isFollowed, setIsFollowed] = useState(false);\n  const [numberOfFollowers, setnumberOfFollowers] = useState('');\n  const [numberOfFollowing, setnumberOfFollowing] = useState('');\n  const user = JSON.parse(localStorage.getItem('user'));\n\n  const getUser = async () => {\n    const res = await fetch(`https://instappmalach.herokuapp.com/user/${id}`);\n    const data = await res.json();\n    setUserProfile(data.user);\n  };\n\n  const getUserPosts = async () => {\n    const res = await fetch(`https://instappmalach.herokuapp.com/post/${id}`);\n    const {\n      postArr,\n      numberOfFollowers,\n      numberOfFollowing\n    } = await res.json();\n    console.log(postArr);\n    setnumberOfFollowers(numberOfFollowers);\n    setnumberOfFollowing(numberOfFollowing);\n    console.log(postArr);\n    setPosts(postArr);\n  };\n\n  const setFollow = async () => {\n    // make unfolow\n    if (isFollowed) {\n      const res = await fetch('https://instappmalach.herokuapp.com/user/unfollow', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          userWhoWantstoUnfollow: user.id,\n          userWhoGetsUnfollowed: id\n        })\n      });\n      const data = await res.json();\n\n      if (data.success) {\n        setIsFollowed(false);\n        setnumberOfFollowers(numberOfFollowers - 1);\n        user.Followings = user.Followings.filter(followed => Number(followed.followed_id) !== Number(id));\n        localStorage.setItem('user', JSON.stringify(user));\n      }\n    } else {\n      // make follow\n      const res = await fetch('https://instappmalach.herokuapp.com/user/follow', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          userWhoWantToFollow: user.id,\n          userWhoGetsFollower: id\n        })\n      });\n      const data = await res.json();\n\n      if (data.success) {\n        setnumberOfFollowers(numberOfFollowers + 1);\n        user.Followings.push({\n          UserId: Number(user.id),\n          followed_id: Number(id)\n        });\n        localStorage.setItem('user', JSON.stringify(user));\n        setIsFollowed(true);\n      }\n    }\n  };\n\n  const handleImageModal = post => {\n    setModalImage(post);\n    setImageModal(true);\n  };\n\n  useEffect(() => {\n    getUser();\n    getUserPosts();\n\n    if (Number(id) === Number(JSON.parse(localStorage.getItem('user')).id)) {\n      setisAllowEdit(true);\n    } else {\n      setisAllowEdit(false);\n    }\n\n    if (user.Followings.find(followed => Number(followed.followed_id) === Number(id))) {\n      setIsFollowed(true);\n    } else {\n      console.log(false);\n      setIsFollowed(false);\n    }\n  }, [modal, id]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [posts && userProfile ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"profile-main\",\n      children: [/*#__PURE__*/_jsxDEV(\"header\", {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"container\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"profile\",\n            style: {\n              margin: '0px'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"profile-image\",\n              children: /*#__PURE__*/_jsxDEV(Image, {\n                cloudName: \"malachcloud\",\n                publicId: userProfile.profile,\n                width: \"200\",\n                crop: \"scale\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 115,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 114,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"profile-user-settings\",\n              children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                className: \"profile-user-name\",\n                children: [\" \", userProfile.username, \" \"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 119,\n                columnNumber: 21\n              }, this), isAllowEdit ? /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"btn profile-edit-btn\",\n                onClick: () => setModal(true),\n                children: \"Edit Profile\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 121,\n                columnNumber: 21\n              }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"btn profile-edit-btn\",\n                onClick: () => setFollow(),\n                children: isFollowed ? 'Unfollow' : 'Follow'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 123,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"btn profile-settings-btn\",\n                children: /*#__PURE__*/_jsxDEV(SettingsIcon, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 125,\n                  columnNumber: 66\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 125,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 118,\n              columnNumber: 18\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"profile-stats\",\n              children: /*#__PURE__*/_jsxDEV(\"ul\", {\n                style: {\n                  padding: '10px 2px 3px'\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"li\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"profile-stat-count\",\n                    children: posts.length\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 130,\n                    columnNumber: 29\n                  }, this), \" posts\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 130,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"profile-stat-count\",\n                    children: numberOfFollowers\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 131,\n                    columnNumber: 29\n                  }, this), \" followers\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 131,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"profile-stat-count\",\n                    children: numberOfFollowing\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 132,\n                    columnNumber: 29\n                  }, this), \" following\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 132,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 129,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 128,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"profile-bio\",\n              children: /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"profile-real-name\",\n                  children: userProfile.username\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 137,\n                  columnNumber: 24\n                }, this), \" \", userProfile.profileDescription, \" \\uD83D\\uDCF7\\u2708\\uFE0F\\uD83C\\uDFD5\\uFE0F\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 137,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 136,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 113,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 12\n      }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"container\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"gallery\",\n            children: /*#__PURE__*/_jsxDEV(Grid, {\n              container: true,\n              children: posts.length !== 0 ? posts.slice(0).reverse().map(post => /*#__PURE__*/_jsxDEV(Grid, {\n                item: true,\n                xs: 4,\n                onClick: () => handleImageModal(post),\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"gallery-item\",\n                  tabIndex: \"0\",\n                  children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                    src: post.photo,\n                    className: \"gallery-image\",\n                    alt: \"\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 150,\n                    columnNumber: 17\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"gallery-item-info\",\n                    children: /*#__PURE__*/_jsxDEV(\"ul\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"li\", {\n                        className: \"gallery-item-likes\",\n                        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                          className: \"visually-hidden\",\n                          children: \"Likes:\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 153,\n                          columnNumber: 60\n                        }, this), \" \", /*#__PURE__*/_jsxDEV(FavoriteIcon, {}, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 153,\n                          columnNumber: 108\n                        }, this), \" \", post.likes]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 153,\n                        columnNumber: 25\n                      }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                        className: \"gallery-item-comments\",\n                        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                          className: \"visually-hidden\",\n                          children: \"Comments:\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 154,\n                          columnNumber: 63\n                        }, this), /*#__PURE__*/_jsxDEV(ChatBubbleRoundedIcon, {}, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 154,\n                          columnNumber: 113\n                        }, this), \" \", post.comments.length]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 154,\n                        columnNumber: 25\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 152,\n                      columnNumber: 21\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 151,\n                    columnNumber: 17\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 149,\n                  columnNumber: 13\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 148,\n                columnNumber: 13\n              }, this)) : /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"no_post_div\",\n                children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n                  children: \"No posts yet\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 161,\n                  columnNumber: 13\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: \"Go back to the home page and upload some..\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 162,\n                  columnNumber: 13\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 160,\n                columnNumber: 9\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 146,\n              columnNumber: 9\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 145,\n            columnNumber: 9\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 5\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 3\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 2\n    }, this), /*#__PURE__*/_jsxDEV(EditProfile, {\n      modal: modal,\n      setModal: setModal\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 1\n    }, this), /*#__PURE__*/_jsxDEV(ProfileImageModal, {\n      imageModal: imageModal,\n      setImageModal: setImageModal,\n      modalImage: modalImage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 1\n    }, this)]\n  }, void 0, true);\n};\n\n_s(Profile, \"plBRcpPKyqCjWzRj3fuGX1rAiuc=\");\n\n_c = Profile;\nexport default Profile;\n\nvar _c;\n\n$RefreshReg$(_c, \"Profile\");","map":{"version":3,"sources":["C:/Users/מלאך גל/Desktop/Projects/Instagram-master/client/src/components/profile/Profile.js"],"names":["React","useState","useEffect","ProfileImageModal","EditProfile","Loader","Grid","SettingsIcon","FavoriteIcon","ChatBubbleRoundedIcon","Image","Profile","props","id","match","params","userProfile","setUserProfile","posts","setPosts","imageModal","setImageModal","modal","setModal","modalImage","setModalImage","isAllowEdit","setisAllowEdit","isFollowed","setIsFollowed","numberOfFollowers","setnumberOfFollowers","numberOfFollowing","setnumberOfFollowing","user","JSON","parse","localStorage","getItem","getUser","res","fetch","data","json","getUserPosts","postArr","console","log","setFollow","method","headers","body","stringify","userWhoWantstoUnfollow","userWhoGetsUnfollowed","success","Followings","filter","followed","Number","followed_id","setItem","userWhoWantToFollow","userWhoGetsFollower","push","UserId","handleImageModal","post","find","margin","profile","username","padding","length","profileDescription","slice","reverse","map","photo","likes","comments"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\n// Components\nimport ProfileImageModal from '../profileImageModal/ProfileImageModal'\nimport EditProfile from '../editProfile/EditProfile'\nimport Loader from '../loader/Loader'\n// Material ui\nimport { Grid } from '@material-ui/core'\nimport SettingsIcon from '@material-ui/icons/Settings';\nimport FavoriteIcon from '@material-ui/icons/Favorite';\nimport ChatBubbleRoundedIcon from '@material-ui/icons/ChatBubbleRounded';\n// Cloudinary\nimport {Image} from 'cloudinary-react';\n// Css\nimport './style.css'\n\n\nconst Profile = (props) =>  {\n    const id = props.match.params.id\n    const [userProfile, setUserProfile] = useState('')\n    const [posts, setPosts] = useState('')\n    const [imageModal, setImageModal] = useState(true)\n    const [modal, setModal] = useState(false)\n    const [modalImage, setModalImage] = useState('')\n    const [isAllowEdit, setisAllowEdit] = useState(false)\n    const [isFollowed, setIsFollowed] = useState(false)\n    const [numberOfFollowers, setnumberOfFollowers] = useState('')\n    const [numberOfFollowing, setnumberOfFollowing] = useState('')\n    const user = JSON.parse(localStorage.getItem('user'))\n    \n    const getUser = async () => {\n        const res = await fetch(`https://instappmalach.herokuapp.com/user/${id}`)\n        const data = await res.json()\n        setUserProfile(data.user)\n    }\n\n\n    const getUserPosts = async () => {\n        const res = await fetch(`https://instappmalach.herokuapp.com/post/${id}`)\n      \n        const { postArr, numberOfFollowers,  numberOfFollowing} = await res.json()\n        console.log(postArr);\n        setnumberOfFollowers(numberOfFollowers)\n        setnumberOfFollowing(numberOfFollowing)\n        console.log(postArr);\n        setPosts(postArr)\n    }\n\n    const setFollow = async () => {\n        // make unfolow\n        if(isFollowed) {\n            const res = await fetch('https://instappmalach.herokuapp.com/user/unfollow', {\n            method: 'POST',\n            headers: {\n                'Content-Type':'application/json'\n            },\n            body: JSON.stringify({userWhoWantstoUnfollow: user.id , userWhoGetsUnfollowed: id })\n          })\n          const data = await res.json()\n          if(data.success) { \n            setIsFollowed(false)\n            setnumberOfFollowers(numberOfFollowers - 1)\n              user.Followings = user.Followings.filter(followed => Number(followed.followed_id) !== Number(id))\n              localStorage.setItem('user', JSON.stringify(user))\n             \n          }\n        } else {\n            // make follow\n                const res = await fetch('https://instappmalach.herokuapp.com/user/follow', {\n                method: 'POST',\n                headers: {\n                    'Content-Type':'application/json'\n                },\n                body: JSON.stringify({userWhoWantToFollow: user.id , userWhoGetsFollower: id })\n              })\n              const data = await res.json()\n              if(data.success) {\n                setnumberOfFollowers(numberOfFollowers + 1)\n                  user.Followings.push({UserId:Number(user.id), followed_id: Number(id)})\n                  localStorage.setItem('user', JSON.stringify(user))\n                  setIsFollowed(true)\n              }\n        \n    }\n}\n\nconst handleImageModal = (post) => {\n    setModalImage(post)\n    setImageModal(true)\n}\n\n    useEffect(() => {\n       getUser()\n       getUserPosts() \n       if (Number(id) === Number(JSON.parse(localStorage.getItem('user')).id)) {\n        setisAllowEdit(true)\n       } else {\n        setisAllowEdit(false)\n       }\n       if(user.Followings.find(followed => Number(followed.followed_id) === Number(id))) {\n        setIsFollowed(true)\n       } else {\n        console.log(false)\n        setIsFollowed(false)\n       }\n    }, [modal,id])\n\n    return (\n        <>\n        {posts && userProfile ?\n        <div className=\"profile-main\">\n           <header>\n            <div className=\"container\">\n              <div className=\"profile\" style={{margin:'0px'}}>\n                  <div className=\"profile-image\">\n                  <Image cloudName=\"malachcloud\" publicId={userProfile.profile} width=\"200\" crop=\"scale\" />\n                  </div>\n\n                 <div className=\"profile-user-settings\">\n                    <h2 className=\"profile-user-name\"> {userProfile.username} </h2>\n                    {isAllowEdit ? \n                    <button className=\"btn profile-edit-btn\" onClick={() => setModal(true)}>Edit Profile</button>\n                    :\n                    <button className=\"btn profile-edit-btn\" onClick={() => setFollow()}>{isFollowed ? 'Unfollow' : 'Follow' }</button>\n                    }\n                    <button className=\"btn profile-settings-btn\"><SettingsIcon/></button>\n                </div>\n\n                <div className=\"profile-stats\">\n                    <ul style={{padding:'10px 2px 3px'}}>\n                        <li><span className=\"profile-stat-count\">{posts.length}</span> posts</li>\n                        <li><span className=\"profile-stat-count\">{numberOfFollowers}</span> followers</li>\n                        <li><span className=\"profile-stat-count\">{numberOfFollowing}</span> following</li>\n                    </ul>\n                </div>\n\n                <div className=\"profile-bio\">\n                    <p><span className=\"profile-real-name\">{userProfile.username}</span> {userProfile.profileDescription} 📷✈️🏕️</p>\n                </div>\n            </div>\n        </div>\n    </header>\n\n  <main>\n    <div className=\"container\">\n        <div className=\"gallery\">\n        <Grid container>\n        {posts.length !== 0 ? posts.slice(0).reverse().map(post => (\n            <Grid item xs={4} onClick={() => handleImageModal(post)}>\n            <div className=\"gallery-item\" tabIndex=\"0\">\n                <img src={post.photo} className=\"gallery-image\" alt=\"\"/>\n                <div className=\"gallery-item-info\">\n                    <ul>\n                        <li className=\"gallery-item-likes\"><span className=\"visually-hidden\">Likes:</span> <FavoriteIcon/> {post.likes}</li>\n                        <li className=\"gallery-item-comments\"><span className=\"visually-hidden\">Comments:</span><ChatBubbleRoundedIcon/> {post.comments.length}</li>\n                    </ul>\n                </div>\n            </div>\n            </Grid>\n        )):\n        <div className=\"no_post_div\">\n            <h1>No posts yet</h1>\n            <p>Go back to the home page and upload some..</p>\n        </div>\n        }\n        </Grid>\n        </div>\n    </div>\n </main> \n\n\n</div>\n:<Loader/>}\n\n<EditProfile modal={modal} setModal={setModal}/> \n<ProfileImageModal imageModal={imageModal} setImageModal={setImageModal} modalImage={modalImage}/>\n        </>\n    )\n}\n\nexport default Profile\n\n\n\n\n"]},"metadata":{},"sourceType":"module"}