{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/\\u05DE\\u05DC\\u05D0\\u05DA \\u05D2\\u05DC/Desktop/Projects/Instagram-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"C:/Users/\\u05DE\\u05DC\\u05D0\\u05DA \\u05D2\\u05DC/Desktop/Projects/Instagram-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"C:/Users/\\u05DE\\u05DC\\u05D0\\u05DA \\u05D2\\u05DC/Desktop/Projects/Instagram-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/\\u05DE\\u05DC\\u05D0\\u05DA \\u05D2\\u05DC/Desktop/Projects/Instagram-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{Link}from'react-router-dom';import Loader from'../loader/Loader';import Story from'../story/Story';import NewUserModal from'./newUserModal/NewUserModal';import ShareModal from'./shareModal/ShareModal';// material ui components\nimport{Divider,Grid,Input,IconButton,Card,CardActions,CardContent,CardHeader,CardMedia,Collapse,Avatar,Typography,TextField,Button,InputAdornment,Hidden,Tooltip}from'@material-ui/core';import{makeStyles,StylesProvider}from'@material-ui/core/styles';import Alert from'@material-ui/lab/Alert';// material ui icons\nimport AddIcon from'@material-ui/icons/Add';import Fab from'@material-ui/core/Fab';import ShareIcon from'@material-ui/icons/Share';import MoreVertIcon from'@material-ui/icons/MoreVert';import ImageIcon from'@material-ui/icons/Image';import ChatBubbleOutlineIcon from'@material-ui/icons/ChatBubbleOutline';import FavoriteBorderOutlinedIcon from'@material-ui/icons/FavoriteBorderOutlined';import CloseIcon from'@material-ui/icons/Close';import MoodIcon from'@material-ui/icons/Mood';import FavoriteIcon from'@material-ui/icons/Favorite';// Formik\nimport{Formik,Form}from'formik';import*as Yup from'yup';// Cloudinary\nimport{Image}from'cloudinary-react';// Bootstrap\nimport Modal from'react-bootstrap/Modal';// intro js\nimport{Steps}from'intro.js-react';import'intro.js/introjs.css';// Css\nimport'./style.css';// moment.js\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var moment=require('moment');// material ui style\nvar useStyles=makeStyles(function(theme){return{root:{display:'flex',justifyContent:'center',marginTop:'30px'},previewcard:{width:'300px',height:'340px',margin:'auto'},media:{height:'550px',width:'550px',paddingTop:'56.25%'// 16:9\n},previewmedia:{width:'300px',height:'200px'},expand:{transform:'rotate(0deg)',marginLeft:'auto',transition:theme.transitions.create('transform',{duration:theme.transitions.duration.shortest})},expandOpen:{transform:'rotate(180deg)'},modalHeader:{display:'flex',justifyContent:'center',fontWeight:'bold'},fab:{position:'fixed',bottom:'10px',left:'75%',whiteSpace:'nowrap',zIndex:'50px',borderRadius:'20px',backgroundColor:'lightblue'},profileBtn:{paddingTop:'10px',marginTop:'10px',marginBottom:'10px'},imageIcon:{marginBottom:'8px',marginRight:'5px'},extendedIcon:{marginRight:theme.spacing(1)},likes:{color:\"#262626\",fontSize:'14px',fontWeight:'600'},comment:{display:'flex',alignItems:'center',marginTop:'18px',color:\"#262626\",fontSize:'14px',fontWeight:'600'},AddCommenttextField:{flexBasis:280,margin:'20px 2px',width:'100%',padding:'1% 0%'},divider:{margin:'15px 0px'},iconButton:{'&:hover':{color:'red'},'&:click':{outline:'none'}},suggestion:{position:'fixed',right:'100px',top:'100px',display:'flex',flexDirection:'column',width:'100%',overflowY:'auto',height:'100%',paddingRight:'20px',scrollbarWidth:'none'},story:{height:'118px',width:'614px',display:'flex',marginLeft:'360px'}};});var Home=function Home(){var classes=useStyles();var user=JSON.parse(localStorage.getItem('user'));var _useState=useState([]),_useState2=_slicedToArray(_useState,2),posts=_useState2[0],setPosts=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),shareModalOpen=_useState4[0],setShareModalOpen=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isBedAlert=_useState6[0],setIsBedAlert=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),commentValue=_useState8[0],setCommentValue=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),previewSource=_useState10[0],setPreviewSource=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),suggestionUsers=_useState12[0],setSuggestionUsers=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),isFollowed=_useState14[0],setIsFollowed=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),isLike=_useState16[0],setIsLike=_useState16[1];var _useState17=useState([]),_useState18=_slicedToArray(_useState17,2),storiesList=_useState18[0],setStoriesList=_useState18[1];var _useState19=useState([]),_useState20=_slicedToArray(_useState19,2),storiesUsers=_useState20[0],setStoriesUsers=_useState20[1];var _useState21=useState(false),_useState22=_slicedToArray(_useState21,2),isProfile=_useState22[0],setIsProfile=_useState22[1];var _useState23=useState(''),_useState24=_slicedToArray(_useState23,2),message=_useState24[0],setMessage=_useState24[1];var _useState25=useState(false),_useState26=_slicedToArray(_useState25,2),openAlert=_useState26[0],setOpenAlert=_useState26[1];var _useState27=useState(''),_useState28=_slicedToArray(_useState27,2),fileName=_useState28[0],setFileName=_useState28[1];var _useState29=useState(false),_useState30=_slicedToArray(_useState29,2),emailModal=_useState30[0],setEmailModal=_useState30[1];// intro js states\nvar _useState31=useState(false),_useState32=_slicedToArray(_useState31,2),firstEntry=_useState32[0],setFirstEntry=_useState32[1];var _useState33=useState(false),_useState34=_slicedToArray(_useState33,2),stepsEnabled=_useState34[0],setStepsEnabled=_useState34[1];var _useState35=useState(0),_useState36=_slicedToArray(_useState35,2),initialStep=_useState36[0],setInitialStep=_useState36[1];var _useState37=useState([{element:\"#stepOne\",intro:\"Start following users to see their special moments and experiences üòé\",position:'left',tooltipClass:'myTooltipClass'},{element:\"#stepTwo\",intro:\"Add your own photo's and video's and start share your feelings with the world! üì∑\",position:'left',tooltipClass:'myTooltipClass'},{element:\"#stepThree\",intro:\"Upload a story daily to update your followers on how you are doing today ü•≥. The story is completely gone after 24 hours\",position:'left',tooltipClass:'myTooltipClass'}]),_useState38=_slicedToArray(_useState37,2),steps=_useState38[0],setSteps=_useState38[1];// Modal functions\nvar closeModal=function closeModal(){return setEmailModal(false);};var openModal=function openModal(){return setEmailModal(true);};// formik validation\nvar validationSchema=Yup.object().shape({photo:Yup.string().required('photo is required'),content:Yup.string().required('content is required')});// Post functions\n// Edit the profile image\nvar editImage=function editImage(values){values.fileName=fileName;if(typeof values.photo==='object'){var reader=new FileReader();reader.readAsDataURL(values.photo);reader.onloadend=function(){setPreviewSource(reader.result);values.photo=reader.result;addNewPost(values);};}else{addNewPost(values);}};// Add new Post\nvar addNewPost=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(values){var newPost,response,data,newPostArray,postObj;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:newPost={photo:values.photo,likes:0,content:values.content,UserId:JSON.parse(localStorage.getItem('user')).id,fileName:values.fileName,date:moment().format('MMMM Do, h:mm a').toString()};_context.prev=1;_context.next=4;return fetch('/post',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(newPost)});case 4:response=_context.sent;_context.next=7;return response.json();case 7:data=_context.sent;if(data.post){console.log(data.post);newPostArray=_toConsumableArray(posts);postObj={index:posts.length,publisher_id:user.id,publisher_username:user.username,publisher_profile:user.profile,post_id:data.post.id,post_content:data.post.content,post_likes:[],post_likes_old:[],post_likeby:[],post_photo:data.post.photo,post_date:data.post.date,post_comments:[]};newPostArray.push(postObj);console.log(newPostArray);setPosts(_toConsumableArray(newPostArray));setIsBedAlert(false);setMessage('Post Added!');setOpenAlert(true);setTimeout(function(){setOpenAlert(false);closeModal();},1000);}else{setIsBedAlert(true);setMessage(data.error);setOpenAlert(true);}_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](1);console.error(_context.t0);case 14:case\"end\":return _context.stop();}}},_callee,null,[[1,11]]);}));return function addNewPost(_x){return _ref.apply(this,arguments);};}();// Makes the preview image\nvar handleChangeImage=function handleChangeImage(e,setFieldValue){var reader=new FileReader();setFieldValue(\"photo\",e.target.files[0]);if(e.target.files.length===0){setIsProfile(false);setFileName('');setPreviewSource('');}else{reader.readAsDataURL(e.target.files[0]);reader.onloadend=function(){setPreviewSource(reader.result);};setIsProfile(true);setFileName(e.target.files[0].name);}};// Add comment \nvar sendComment=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(PostId,index){var newArr,renderComment,comment,response,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:newArr=posts;renderComment={time:moment().startOf('hour').fromNow().toString(),content:commentValue,commenter:JSON.parse(localStorage.getItem('user')).username,commenter_profile:JSON.parse(localStorage.getItem('user')).profile};console.log(newArr[index].post_comments);newArr[index].post_comments.push(renderComment);console.log(newArr[index].post_comments);setPosts(_toConsumableArray(newArr));comment={time:moment().startOf('hour').fromNow().toString(),content:commentValue,PostId:PostId,UserId:JSON.parse(localStorage.getItem('user')).id};_context2.prev=7;_context2.next=10;return fetch('/comment',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(comment)});case 10:response=_context2.sent;_context2.next=13;return response.json();case 13:data=_context2.sent;if(data.comment){// console.log(data.comment)\n}else{console.log('error');}_context2.next=20;break;case 17:_context2.prev=17;_context2.t0=_context2[\"catch\"](7);console.error(_context2.t0);case 20:case\"end\":return _context2.stop();}}},_callee2,null,[[7,17]]);}));return function sendComment(_x2,_x3){return _ref2.apply(this,arguments);};}();// Add Like\nvar addLike=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(id,index,isLike){var newArr,add;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;newArr=posts;if(!isLike){newArr[index].post_likeby.push(user.username);newArr[index].like=true;setPosts(_toConsumableArray(newArr));add=true;}else{console.log('remove');newArr[index].post_likeby=newArr[index].post_likeby.filter(function(like){return like!==user.username;});newArr[index].like=false;setPosts(_toConsumableArray(newArr));add=false;}_context3.next=5;return fetch('/post/like',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({add:add,PostId:id,UserId:user.id})});case 5:_context3.next=10;break;case 7:_context3.prev=7;_context3.t0=_context3[\"catch\"](0);console.log(_context3.t0);case 10:case\"end\":return _context3.stop();}}},_callee3,null,[[0,7]]);}));return function addLike(_x4,_x5,_x6){return _ref3.apply(this,arguments);};}();// Get all the posts\nvar getPosts=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var postsArr,index,res,data;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:postsArr=[];index=0;_context4.next=4;return fetch('/post');case 4:res=_context4.sent;_context4.next=7;return res.json();case 7:data=_context4.sent;data.forEach(function(item){if(user.Followings.find(function(followed){return followed.followed_id===item.publisher_id;})||user.id===item.publisher_id||item.publisher_username===\"instagram\"){item.posts.forEach(function(post){var post_likeby=[];post.post_likes.forEach(function(like){return post_likeby.push(like.like_username);});var isLike=Boolean(post.post_likes.find(function(likedUser){return Number(likedUser.like_userid)===Number(user.id);}));var postObj={index:index,publisher_id:item.publisher_id,publisher_username:item.publisher_username,publisher_profile:item.publisher_profile,post_id:post.post_id,post_content:post.post_content,post_likes:post.post_likes.length,post_likes_old:post.post_likes.length,post_likeby:post_likeby,post_photo:post.post_photo,post_date:post.post_date,like:isLike,post_comments:post.post_comments};index++;postsArr.push(postObj);});}});console.log(postsArr);setPosts(postsArr);case 11:case\"end\":return _context4.stop();}}},_callee4);}));return function getPosts(){return _ref4.apply(this,arguments);};}();var getStories=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var res,_yield$res$json,stories,storyArr;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return fetch('/story');case 2:res=_context5.sent;_context5.next=5;return res.json();case 5:_yield$res$json=_context5.sent;stories=_yield$res$json.stories;storyArr=[];stories.forEach(function(story){if(story.User.Followers.find(function(follower){return Number(follower.follower_id)===Number(user.id);})||Number(story.User.id)===Number(user.id)||story.User.username===\"instagram\"){if(!storyArr.find(function(user){return user.username===story.User.username;})){storyArr.push(story.User);}}});setStoriesUsers(storyArr);case 10:case\"end\":return _context5.stop();}}},_callee5);}));return function getStories(){return _ref5.apply(this,arguments);};}();// Get all suggestion users\nvar getSuggestionUsers=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){var res,_yield$res$json2,users,suggestionArr;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.prev=0;_context6.next=3;return fetch('/user');case 3:res=_context6.sent;_context6.next=6;return res.json();case 6:_yield$res$json2=_context6.sent;users=_yield$res$json2.users;suggestionArr=[];users.forEach(function(suggestionUser){if(!suggestionUser.Followers.find(function(follower){return Number(follower.follower_id)===Number(user.id);})&&Number(suggestionUser.id)!==Number(user.id)&&suggestionUser.username!=='instagram'){suggestionArr.push(suggestionUser);}});setSuggestionUsers(suggestionArr);_context6.next=16;break;case 13:_context6.prev=13;_context6.t0=_context6[\"catch\"](0);console.error(_context6.t0);case 16:case\"end\":return _context6.stop();}}},_callee6,null,[[0,13]]);}));return function getSuggestionUsers(){return _ref6.apply(this,arguments);};}();var setFollow=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(id){var res,data,newSuggestedUserArr;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return fetch('/user/follow',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({userWhoWantToFollow:user.id,userWhoGetsFollower:id})});case 2:res=_context7.sent;_context7.next=5;return res.json();case 5:data=_context7.sent;if(data.success){newSuggestedUserArr=suggestionUsers.filter(function(user){return user.id!==id;});setSuggestionUsers(_toConsumableArray(newSuggestedUserArr));user.Followings.push({UserId:Number(user.id),followed_id:Number(id)});localStorage.setItem('user',JSON.stringify(user));}case 7:case\"end\":return _context7.stop();}}},_callee7);}));return function setFollow(_x7){return _ref7.apply(this,arguments);};}();// intro js functions\nvar onExit=function onExit(){setStepsEnabled(false);setFirstEntry(false);};useEffect(function(){if(user.newUser){setFirstEntry(true);user.newUser=false;localStorage.setItem('user',JSON.stringify(user));}else{setFirstEntry(false);}getPosts();getStories();getSuggestionUsers();},[]);return/*#__PURE__*/_jsxs(_Fragment,{children:[firstEntry?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(NewUserModal,{stepsEnabled:stepsEnabled,setStepsEnabled:setStepsEnabled}),/*#__PURE__*/_jsx(Steps,{enabled:stepsEnabled,steps:steps,initialStep:initialStep,onExit:onExit})]}):null,/*#__PURE__*/_jsx(StylesProvider,{injectFirst:true,children:/*#__PURE__*/_jsxs(Grid,{container:true,children:[/*#__PURE__*/_jsx(Grid,{item:true,className:classes.story,sm:4,md:4,children:storiesUsers.length!==0&&/*#__PURE__*/_jsx(Story,{storiesUsers:storiesUsers})}),posts?posts.slice(0).reverse().map(function(post){return/*#__PURE__*/_jsx(Grid,{item:true,sm:12,md:10,className:classes.root,children:/*#__PURE__*/_jsxs(Card,{className:classes.card,children:[/*#__PURE__*/_jsx(CardHeader,{avatar:/*#__PURE__*/_jsxs(Avatar,{children:[/*#__PURE__*/_jsx(Image,{cloudName:\"malachcloud\",publicId:post.publisher_profile,width:\"70\",height:\"40\",crop:\"scale\"}),\" \"]}),action:/*#__PURE__*/_jsxs(IconButton,{children:[\" \",/*#__PURE__*/_jsx(MoreVertIcon,{}),\" \"]}),title:/*#__PURE__*/_jsx(Link,{to:\"/profile/\".concat(post.publisher_id),children:/*#__PURE__*/_jsx(\"span\",{className:classes.likes,children:post.publisher_username})})}),/*#__PURE__*/_jsx(CardMedia,{className:classes.media,image:post.post_photo}),/*#__PURE__*/_jsxs(CardActions,{disableSpacing:true,children:[/*#__PURE__*/_jsxs(IconButton,{className:classes.iconButton,onClick:function onClick(){return addLike(post.post_id,post.index,post.like);},children:[post.like?/*#__PURE__*/_jsx(FavoriteIcon,{style:{fill:\"red\"}}):/*#__PURE__*/_jsx(FavoriteBorderOutlinedIcon,{}),\" \"]}),/*#__PURE__*/_jsxs(IconButton,{children:[\" \",/*#__PURE__*/_jsx(ChatBubbleOutlineIcon,{}),\" \"]}),/*#__PURE__*/_jsxs(IconButton,{children:[\" \",/*#__PURE__*/_jsx(ShareIcon,{onClick:function onClick(){return setShareModalOpen(true);}}),\" \"]}),/*#__PURE__*/_jsx(ShareModal,{shareModalOpen:shareModalOpen,setShareModalOpen:setShareModalOpen})]}),/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsxs(Typography,{className:classes.likes,children:[post.post_likeby.length===0&&'be the first one to like this post!',post.post_likeby.length===1&&\"liked by \".concat(post.post_likeby[0]===user.username?'you':post.post_likeby[0]),post.post_likeby.length===2&&\"liked by \".concat(post.post_likeby[0]===user.username?'you':post.post_likeby[0],\", \").concat(post.post_likeby[1]===user.username?'you':post.post_likeby[1]),post.post_likeby.length>2&&\"liked by \".concat(post.post_likeby[0]===user.username?'you':post.post_likeby[0],\", \").concat(post.post_likeby[1]===user.username?'you':post.post_likeby[1],\" and \").concat(post.post_likeby.length-2,\" others\")]}),/*#__PURE__*/_jsxs(Typography,{className:classes.likes,children:[/*#__PURE__*/_jsxs(Link,{to:\"/profile/\".concat(post.publisher_id),style:{color:'black'},children:[\" \",post.publisher_username,\" \"]}),\" \",/*#__PURE__*/_jsxs(\"span\",{className:\"post-content\",children:[\" \",post.post_content,\" \"]})]}),/*#__PURE__*/_jsx(Divider,{className:classes.divider}),post.post_comments.map(function(comment){return/*#__PURE__*/_jsxs(Typography,{className:classes.comment,children:[/*#__PURE__*/_jsxs(Avatar,{children:[/*#__PURE__*/_jsx(Image,{cloudName:\"malachcloud\",publicId:comment.commenter_profile,width:\"80\"}),\" \"]}),/*#__PURE__*/_jsxs(Link,{to:\"/profile/\".concat(comment.commenter_id),style:{color:'black'},children:[\" \",/*#__PURE__*/_jsxs(\"span\",{className:\"commeter\",children:[comment.commenter,\" \"]}),\" \"]}),/*#__PURE__*/_jsx(\"span\",{className:\"post-content\",children:comment.content})]});}),/*#__PURE__*/_jsx(\"div\",{className:\"post-date\",children:post.post_date}),/*#__PURE__*/_jsx(Divider,{className:classes.divider}),/*#__PURE__*/_jsx(TextField,{className:classes.AddCommenttextField,variant:\"outlined\",type:\"text\",label:\"Add a comment...\",onChange:function onChange(e){return setCommentValue(e.target.value);},InputProps:{startAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"start\",children:/*#__PURE__*/_jsxs(IconButton,{children:[\" \",/*#__PURE__*/_jsx(MoodIcon,{})]})}),endAdornment:/*#__PURE__*/_jsx(InputAdornment,{position:\"end\",children:/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return sendComment(post.post_id,post.index);},color:\"primary\",children:\"Post\"})})}})]})]})});}):/*#__PURE__*/_jsx(Loader,{}),/*#__PURE__*/_jsx(Hidden,{smDown:true,children:/*#__PURE__*/_jsxs(Grid,{item:true,className:classes.suggestion,md:3,children:[/*#__PURE__*/_jsxs(\"div\",{id:\"stepOne\",children:[\" \",/*#__PURE__*/_jsx(\"h6\",{className:\"user-suggested-headline\",children:\"Suggestions For You\"}),\" \"]}),suggestionUsers&&suggestionUsers.map(function(user){return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(CardHeader,{avatar:/*#__PURE__*/_jsxs(Avatar,{children:[/*#__PURE__*/_jsx(Image,{cloudName:\"malachcloud\",publicId:user.profile,width:\"70\",height:\"40\",crop:\"scale\"}),\" \"]}),action:/*#__PURE__*/_jsxs(IconButton,{style:{marginRight:'10px'},onClick:function onClick(){return setFollow(user.id);},children:[\" \",/*#__PURE__*/_jsx(\"h6\",{className:\"user-suggested-follow\",children:\"Follow\"}),\" \"]}),title:/*#__PURE__*/_jsx(Link,{to:\"/profile/\".concat(user.id),children:/*#__PURE__*/_jsx(\"span\",{className:classes.likes,children:user.username})}),subheader:\"New to Instagram\",style:{width:'110%'}})});})]})}),/*#__PURE__*/_jsx(Fab,{id:\"stepTwo\",color:\"primary\",className:classes.fab,onClick:function onClick(){return openModal();},title:\"Add new post\",children:/*#__PURE__*/_jsx(AddIcon,{})}),/*#__PURE__*/_jsxs(Modal,{size:\"lg\",centered:true,show:emailModal,onHide:closeModal,style:{margin:'70px auto 30px',maxHeight:'90%',overflowY:'auto'},children:[/*#__PURE__*/_jsxs(Modal.Header,{className:classes.modalHeader,children:[\" \",/*#__PURE__*/_jsx(Modal.Title,{style:{fontWeight:'700'},children:\" Add new post \"}),\" \"]}),/*#__PURE__*/_jsx(Modal.Body,{children:/*#__PURE__*/_jsx(Formik,{initialValues:{photo:'',content:''},validationSchema:validationSchema,onSubmit:editImage,children:function children(_ref8){var errors=_ref8.errors,touched=_ref8.touched,setFieldValue=_ref8.setFieldValue;return/*#__PURE__*/_jsxs(Form,{style:{textAlign:'center'},children:[/*#__PURE__*/_jsx(Input,{id:\"file\",className:\"inputfile\",type:\"file\",name:\"photo\",onChange:function onChange(e){return handleChangeImage(e,setFieldValue);},hidden:true}),/*#__PURE__*/_jsxs(Button,{className:classes.profileBtn,color:\"primary\",variant:\"outlined\",children:[/*#__PURE__*/_jsx(ImageIcon,{className:classes.imageIcon}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"file\",children:[fileName?\"\".concat(fileName,\" UPLOADED\"):'UPLPOAD IMAGE',\" \"]})]}),errors.photo&&touched.photo?/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:errors.photo}):null,previewSource?/*#__PURE__*/_jsxs(Card,{className:classes.previewcard,children:[/*#__PURE__*/_jsx(CardHeader,{avatar:/*#__PURE__*/_jsxs(Avatar,{children:[/*#__PURE__*/_jsx(Image,{cloudName:\"malachcloud\",publicId:user.profile,width:\"80\",crop:\"scale\"}),\" \"]}),action:/*#__PURE__*/_jsxs(IconButton,{children:[\" \",/*#__PURE__*/_jsx(MoreVertIcon,{}),\" \"]}),title:/*#__PURE__*/_jsx(\"span\",{className:classes.likes,children:user.username})}),/*#__PURE__*/_jsx(CardMedia,{className:classes.previewmedia,image:previewSource}),/*#__PURE__*/_jsxs(CardActions,{disableSpacing:true,children:[/*#__PURE__*/_jsxs(IconButton,{className:classes.iconButton,children:[\" \",/*#__PURE__*/_jsx(FavoriteIcon,{style:{fill:\"red\"}}),\" \"]}),/*#__PURE__*/_jsxs(IconButton,{children:[\" \",/*#__PURE__*/_jsx(ChatBubbleOutlineIcon,{}),\" \"]}),/*#__PURE__*/_jsxs(IconButton,{children:[\" \",/*#__PURE__*/_jsx(ShareIcon,{}),\" \"]})]})]}):null,/*#__PURE__*/_jsx(TextField,{multiline:true,rows:4,variant:\"outlined\",margin:\"normal\",fullWidth:true,label:\"add description\",name:\"content\",onChange:function onChange(event){return setFieldValue(\"content\",event.target.value);}}),errors.content&&touched.content?/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:errors.content}):null,/*#__PURE__*/_jsx(Collapse,{in:openAlert,children:/*#__PURE__*/_jsx(Alert,{style:{margin:'10px'},severity:isBedAlert?\"error\":\"success\",action:/*#__PURE__*/_jsxs(IconButton,{color:\"inherit\",size:\"small\",onClick:function onClick(){return setOpenAlert(false);},children:[\" \",/*#__PURE__*/_jsx(CloseIcon,{fontSize:\"inherit\"}),\" \"]}),children:message})}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",color:\"primary\",type:\"Submit\",children:\"Submit\"})]});}})})]})]})})]});};export default Home;","map":{"version":3,"sources":["C:/Users/◊û◊ú◊ê◊ö ◊í◊ú/Desktop/Projects/Instagram-master/client/src/components/home/Home.js"],"names":["React","useEffect","useState","Link","Loader","Story","NewUserModal","ShareModal","Divider","Grid","Input","IconButton","Card","CardActions","CardContent","CardHeader","CardMedia","Collapse","Avatar","Typography","TextField","Button","InputAdornment","Hidden","Tooltip","makeStyles","StylesProvider","Alert","AddIcon","Fab","ShareIcon","MoreVertIcon","ImageIcon","ChatBubbleOutlineIcon","FavoriteBorderOutlinedIcon","CloseIcon","MoodIcon","FavoriteIcon","Formik","Form","Yup","Image","Modal","Steps","moment","require","useStyles","theme","root","display","justifyContent","marginTop","previewcard","width","height","margin","media","paddingTop","previewmedia","expand","transform","marginLeft","transition","transitions","create","duration","shortest","expandOpen","modalHeader","fontWeight","fab","position","bottom","left","whiteSpace","zIndex","borderRadius","backgroundColor","profileBtn","marginBottom","imageIcon","marginRight","extendedIcon","spacing","likes","color","fontSize","comment","alignItems","AddCommenttextField","flexBasis","padding","divider","iconButton","outline","suggestion","right","top","flexDirection","overflowY","paddingRight","scrollbarWidth","story","Home","classes","user","JSON","parse","localStorage","getItem","posts","setPosts","shareModalOpen","setShareModalOpen","isBedAlert","setIsBedAlert","commentValue","setCommentValue","previewSource","setPreviewSource","suggestionUsers","setSuggestionUsers","isFollowed","setIsFollowed","isLike","setIsLike","storiesList","setStoriesList","storiesUsers","setStoriesUsers","isProfile","setIsProfile","message","setMessage","openAlert","setOpenAlert","fileName","setFileName","emailModal","setEmailModal","firstEntry","setFirstEntry","stepsEnabled","setStepsEnabled","initialStep","setInitialStep","element","intro","tooltipClass","steps","setSteps","closeModal","openModal","validationSchema","object","shape","photo","string","required","content","editImage","values","reader","FileReader","readAsDataURL","onloadend","result","addNewPost","newPost","UserId","id","date","format","toString","fetch","method","headers","body","stringify","response","json","data","post","console","log","newPostArray","postObj","index","length","publisher_id","publisher_username","username","publisher_profile","profile","post_id","post_content","post_likes","post_likes_old","post_likeby","post_photo","post_date","post_comments","push","setTimeout","error","handleChangeImage","e","setFieldValue","target","files","name","sendComment","PostId","newArr","renderComment","time","startOf","fromNow","commenter","commenter_profile","addLike","like","add","filter","getPosts","postsArr","res","forEach","item","Followings","find","followed","followed_id","like_username","Boolean","likedUser","Number","like_userid","getStories","stories","storyArr","User","Followers","follower","follower_id","getSuggestionUsers","users","suggestionArr","suggestionUser","setFollow","userWhoWantToFollow","userWhoGetsFollower","success","newSuggestedUserArr","setItem","onExit","newUser","slice","reverse","map","card","fill","commenter_id","value","startAdornment","endAdornment","maxHeight","errors","touched","textAlign","event"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { Link } from 'react-router-dom'\nimport Loader from '../loader/Loader'\nimport Story from '../story/Story'\nimport NewUserModal from './newUserModal/NewUserModal'\nimport ShareModal from './shareModal/ShareModal'\n// material ui components\nimport { Divider, Grid, Input, IconButton, Card, CardActions, CardContent, CardHeader, CardMedia, Collapse, Avatar, Typography, TextField, Button, InputAdornment, Hidden, Tooltip  } from '@material-ui/core';\nimport { makeStyles, StylesProvider } from '@material-ui/core/styles';\nimport Alert from '@material-ui/lab/Alert';\n// material ui icons\nimport AddIcon from '@material-ui/icons/Add';\nimport Fab from '@material-ui/core/Fab';\nimport ShareIcon from '@material-ui/icons/Share';\nimport MoreVertIcon from '@material-ui/icons/MoreVert';\nimport ImageIcon from '@material-ui/icons/Image';\nimport ChatBubbleOutlineIcon from '@material-ui/icons/ChatBubbleOutline';\nimport FavoriteBorderOutlinedIcon from '@material-ui/icons/FavoriteBorderOutlined';\nimport CloseIcon from '@material-ui/icons/Close';\nimport MoodIcon from '@material-ui/icons/Mood';\nimport FavoriteIcon from '@material-ui/icons/Favorite';\n// Formik\nimport { Formik, Form} from 'formik';\nimport * as Yup from 'yup';\n// Cloudinary\nimport {Image} from 'cloudinary-react';\n// Bootstrap\nimport Modal from 'react-bootstrap/Modal'\n// intro js\nimport { Steps } from 'intro.js-react';\nimport 'intro.js/introjs.css';\n// Css\nimport './style.css'\n\n// moment.js\nconst moment = require('moment')\n\n// material ui style\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    display:'flex',\n    justifyContent:'center',\n    marginTop:'30px'\n  },\n  previewcard:{\n    width:'300px',\n    height:'340px',\n    margin:'auto'\n  },\n  media: {\n    height: '550px',\n    width:'550px',\n    paddingTop: '56.25%', // 16:9\n  },\n  previewmedia: {\n    width:'300px',\n    height:'200px'\n  },\n  expand: {\n    transform: 'rotate(0deg)',\n    marginLeft: 'auto',\n    transition: theme.transitions.create('transform', {\n      duration: theme.transitions.duration.shortest,\n    }),\n  },\n  expandOpen: {\n    transform: 'rotate(180deg)',\n  },\n  modalHeader: {\n   display: 'flex',\n   justifyContent: 'center',\n   fontWeight:'bold',\n  },\n  fab: {\n    position:'fixed',\n    bottom: '10px',\n    left: '75%',\n    whiteSpace: 'nowrap',\n    zIndex: '50px',\n    borderRadius:'20px',\n    backgroundColor:'lightblue'\n  },\n  profileBtn: {\n    paddingTop:'10px',\n    marginTop:'10px',\n    marginBottom:'10px'\n  },\n  imageIcon: {\n    marginBottom:'8px',\n    marginRight:'5px'\n  },\n  extendedIcon: { \n    marginRight: theme.spacing(1),\n  },\n  likes: {\n    color: \"#262626\",\n    fontSize:'14px',\n    fontWeight: '600',\n  },\n  comment: {\n    display:'flex',\n    alignItems:'center',\n    marginTop:'18px',\n    color: \"#262626\",\n    fontSize:'14px',\n    fontWeight: '600',\n  },\n  AddCommenttextField: {\n    flexBasis: 280,\n    margin: '20px 2px',\n    width:'100%',\n    padding:'1% 0%',\n    \n  },\n  divider: {\n    margin:'15px 0px'\n  },\n  iconButton: {\n    '&:hover': {\n      color:'red'\n    },\n    '&:click': {\n      outline: 'none'\n    },\n  },\n  suggestion: {\n    position: 'fixed',\n    right: '100px',\n    top: '100px',\n    display:'flex',\n    flexDirection: 'column',\n    width: '100%',\n    overflowY:'auto',\n    height:'100%',\n    paddingRight:'20px',\n    scrollbarWidth: 'none'\n  },\n  story: {\n    height:'118px',\n    width:'614px',\n    display:'flex',\n    marginLeft:'360px'\n  }\n}))\n\n const Home = () => {\n  const classes = useStyles()\n  const user = JSON.parse(localStorage.getItem('user'))\n  const [posts, setPosts] = useState([])\n  const [shareModalOpen, setShareModalOpen] = useState(false)\n  const [isBedAlert, setIsBedAlert] = useState(false)\n  const [commentValue, setCommentValue] = useState('')\n  const [previewSource, setPreviewSource] = useState('')\n  const [suggestionUsers, setSuggestionUsers] = useState([])\n  const [isFollowed, setIsFollowed] = useState(false)\n  const [isLike, setIsLike] = useState(false)\n  const [storiesList, setStoriesList] = useState([])\n  const [storiesUsers, setStoriesUsers] = useState([])\n  const [isProfile, setIsProfile] = useState(false)\n  const [message, setMessage] = useState('')\n  const [openAlert, setOpenAlert] = useState(false)\n  const [fileName, setFileName] = useState('')\n  const [emailModal, setEmailModal] = useState(false)\n  // intro js states\n  const [firstEntry, setFirstEntry] = useState(false)\n  const [stepsEnabled, setStepsEnabled] = useState(false)\n  const [initialStep, setInitialStep] = useState(0)\n  const [steps, setSteps] = useState([\n      { element:\"#stepOne\", intro: \"Start following users to see their special moments and experiences üòé\", position: 'left', tooltipClass: 'myTooltipClass' },\n      { element:\"#stepTwo\", intro: \"Add your own photo's and video's and start share your feelings with the world! üì∑\", position: 'left', tooltipClass: 'myTooltipClass' },\n      { element:\"#stepThree\", intro: \"Upload a story daily to update your followers on how you are doing today ü•≥. The story is completely gone after 24 hours\", position: 'left', tooltipClass: 'myTooltipClass' },\n  ])\n\n  // Modal functions\n  const closeModal = () => setEmailModal(false)\n  const openModal = () => setEmailModal(true)\n\n  // formik validation\n  const validationSchema = Yup.object().shape({\n    photo:Yup.string()\n    .required('photo is required'),\n    content:Yup.string()\n    .required('content is required')\n  })\n\n// Post functions\n\n// Edit the profile image\n  const editImage =  (values) => {\n    values.fileName = fileName\n    if(typeof values.photo === 'object' ) {\n    const reader = new FileReader()\n    reader.readAsDataURL(values.photo)\n    reader.onloadend = () => {\n      setPreviewSource(reader.result)\n      values.photo = reader.result\n      addNewPost(values)\n    }\n    } else {\n      addNewPost(values)\n    }\n  }\n\n  // Add new Post\n  const addNewPost = async (values) => {\n      const newPost = {\n        photo: values.photo,\n        likes: 0,\n        content: values.content,\n        UserId : JSON.parse(localStorage.getItem('user')).id,\n        fileName: values.fileName,\n        date: moment().format('MMMM Do, h:mm a').toString()\n      }\n        try {\n          const response = await fetch('/post', { \n          method: 'POST',\n          headers: {\n              'Content-Type':'application/json'\n          },\n          body: JSON.stringify(newPost)\n        })\n        const data = await response.json()\n        if(data.post){\n          console.log(data.post);\n          const newPostArray = [...posts]\n          const postObj = {\n            index: posts.length,\n            publisher_id: user.id,\n            publisher_username: user.username,\n            publisher_profile: user.profile,\n            post_id: data.post.id,\n            post_content: data.post.content,\n            post_likes: [],\n            post_likes_old: [],\n            post_likeby: [],\n            post_photo: data.post.photo,\n            post_date: data.post.date,\n            post_comments: []\n          }\n          newPostArray.push(postObj)\n          console.log(newPostArray)\n          setPosts([...newPostArray])\n          setIsBedAlert(false)\n          setMessage('Post Added!')\n          setOpenAlert(true)\n          setTimeout(() => {\n            setOpenAlert(false)\n            closeModal()\n          },1000)\n        } else {\n          setIsBedAlert(true)\n          setMessage(data.error)\n          setOpenAlert(true)\n        }\n\n      } catch (error) {\n          console.error(error)\n        }\n  }\n\n  // Makes the preview image\n  const handleChangeImage = (e,setFieldValue) => {\n      const reader = new FileReader()\n      setFieldValue(\"photo\", e.target.files[0])\n      if(e.target.files.length === 0) {\n        setIsProfile(false)\n        setFileName('')\n        setPreviewSource('')\n      } \n      else {\n        reader.readAsDataURL(e.target.files[0])\n        reader.onloadend = () => {\n          setPreviewSource(reader.result)\n        }\n        setIsProfile(true)\n        setFileName(e.target.files[0].name)\n      }\n  }\n\n  // Add comment \n  const sendComment = async (PostId, index) => {\n    const newArr = posts\n    const renderComment = {\n      time: moment().startOf('hour').fromNow().toString(),\n      content: commentValue,\n      commenter:JSON.parse(localStorage.getItem('user')).username,\n      commenter_profile:JSON.parse(localStorage.getItem('user')).profile,\n    }\n    console.log(newArr[index].post_comments);\n    newArr[index].post_comments.push(renderComment)\n    console.log(newArr[index].post_comments);\n    setPosts([...newArr])\n\n    const comment = {\n      time: moment().startOf('hour').fromNow().toString(),\n      content: commentValue,\n      PostId,\n      UserId: JSON.parse(localStorage.getItem('user')).id,\n    }\n    try {\n      const response = await fetch('/comment', { \n      method: 'POST',\n      headers: {\n          'Content-Type':'application/json'\n      },\n      body: JSON.stringify(comment)\n    })\n    const data = await response.json()\n    if(data.comment){\n      // console.log(data.comment)\n    } else {\n      console.log('error')\n    }\n  } catch (error) {\n      console.error(error)\n    }\n  }\n  // Add Like\n  const addLike = async (id,index, isLike) => {\n    try {\n      const newArr = posts\n      let add\n      if(!isLike) { \n        newArr[index].post_likeby.push(user.username)\n        newArr[index].like = true\n        setPosts([...newArr])\n        add = true\n      } else {\n        console.log('remove');\n        newArr[index].post_likeby =  newArr[index].post_likeby.filter(like => like !== user.username)\n       \n        newArr[index].like = false\n        setPosts([...newArr])\n        add = false\n      }\n      await fetch('/post/like', { \n        method: 'POST',\n        headers: {\n            'Content-Type':'application/json'\n        },\n        body: JSON.stringify({ add, PostId:id, UserId:user.id })\n      })\n    } catch (error) {\n      console.log(error)\n    }\n \n  }\n  // Get all the posts\n  const getPosts = async () => {\n    const postsArr = []\n    let index = 0\n    const res = await fetch('/post')\n    const data = await res.json()\n    data.forEach((item) => {\n      if(user.Followings.find(followed => followed.followed_id === item.publisher_id) || user.id === item.publisher_id || item.publisher_username === \"instagram\"){\n        item.posts.forEach((post) => {\n          const post_likeby = []\n          post.post_likes.forEach(like => post_likeby.push(like.like_username))\n          const isLike = Boolean(post.post_likes.find(likedUser => Number(likedUser.like_userid) === Number(user.id)))\n          const postObj = {\n            index,\n            publisher_id: item.publisher_id,\n            publisher_username: item.publisher_username,\n            publisher_profile: item.publisher_profile,\n            post_id: post.post_id,\n            post_content: post.post_content,\n            post_likes: post.post_likes.length,\n            post_likes_old: post.post_likes.length,\n            post_likeby,\n            post_photo: post.post_photo,\n            post_date: post.post_date,\n            like:isLike,\n            post_comments: post.post_comments\n          }\n          index ++\n          postsArr.push(postObj)\n         \n        })\n      }\n    })\n    console.log(postsArr);\n    setPosts(postsArr)\n}\n\nconst getStories = async () => {\n  const res = await fetch('/story')\n  const { stories } = await res.json()\n  const storyArr = []\n  stories.forEach(story => {\n    if(story.User.Followers.find(follower => Number(follower.follower_id) === Number(user.id)) || Number(story.User.id) === Number(user.id) || story.User.username === \"instagram\") {\n      if(!(storyArr.find(user => user.username === story.User.username))) {\n        storyArr.push(story.User)\n      }\n    }\n  })\n  \n  setStoriesUsers(storyArr)\n}\n\n// Get all suggestion users\nconst getSuggestionUsers = async () => {\n  try {\n    const res = await fetch('/user')\n    const { users } = await res.json()\n    \n    const suggestionArr = []\n   \n    users.forEach(suggestionUser => {\n      if(!(suggestionUser.Followers.find(follower => Number(follower.follower_id) === Number(user.id))) && (Number(suggestionUser.id) !== Number(user.id)) && (suggestionUser.username !== 'instagram')){\n        suggestionArr.push(suggestionUser)\n      }\n    })\n \n\n    setSuggestionUsers(suggestionArr)\n \n} catch (error) {\n    console.error(error)\n  }\n}\n\nconst setFollow = async (id) => {\n      // make follow\n          const res = await fetch('/user/follow', {\n          method: 'POST',\n          headers: {\n              'Content-Type':'application/json'\n          },\n          body: JSON.stringify({userWhoWantToFollow: user.id , userWhoGetsFollower: id })\n        })\n        const data = await res.json()\n        if(data.success) {\n            const newSuggestedUserArr = suggestionUsers.filter(user => user.id !== id)\n            setSuggestionUsers([...newSuggestedUserArr])\n            user.Followings.push({UserId:Number(user.id), followed_id: Number(id)})\n            localStorage.setItem('user', JSON.stringify(user))\n        }\n}\n\n// intro js functions\nconst onExit = () => {\n  setStepsEnabled(false)\n  setFirstEntry(false)\n}\n  useEffect(() => {\n    if(user.newUser) {\n      setFirstEntry(true)\n      user.newUser = false\n      localStorage.setItem('user',JSON.stringify(user))\n    }\n     else {\n      setFirstEntry(false)\n     }\n   \n    getPosts()\n    getStories()\n    getSuggestionUsers()\n  \n  }, [])\n\n\n  return (\n    <>\n    {firstEntry ? \n    <>\n    <NewUserModal stepsEnabled={stepsEnabled} setStepsEnabled={setStepsEnabled}/>\n    <Steps enabled={stepsEnabled} steps={steps} initialStep={initialStep} onExit={onExit}/>\n    </>\n     : null}\n   <StylesProvider injectFirst>\n   <Grid container>\n   <Grid item className={classes.story} sm={4} md={4}>\n    {storiesUsers.length !== 0  &&  <Story storiesUsers={storiesUsers} />}\n   </Grid>\n\n       {posts ?  posts.slice(0).reverse().map(post => (\n         <Grid item sm={12} md={10} className={classes.root} >\n         <Card className={classes.card}>\n          <CardHeader\n            avatar={ <Avatar><Image cloudName=\"malachcloud\" publicId={post.publisher_profile} width=\"70\" height=\"40\" crop=\"scale\" /> </Avatar>}\n            action={ <IconButton> <MoreVertIcon /> </IconButton> }\n            title={<Link to={`/profile/${post.publisher_id}`}><span className={classes.likes}>{post.publisher_username}</span></Link>}\n          />\n\n          <CardMedia className={classes.media} image={post.post_photo}></CardMedia>\n\n          <CardActions disableSpacing>\n            <IconButton className={classes.iconButton} onClick={() => addLike(post.post_id, post.index, post.like)}>{post.like ? <FavoriteIcon style={{fill: \"red\"}}/> : <FavoriteBorderOutlinedIcon /> } </IconButton>\n            <IconButton> <ChatBubbleOutlineIcon/> </IconButton>\n            <IconButton > <ShareIcon onClick={() => setShareModalOpen(true)}/> </IconButton>\n            <ShareModal shareModalOpen={shareModalOpen} setShareModalOpen={setShareModalOpen} /> \n          </CardActions>\n\n          <CardContent>\n          <Typography className={classes.likes}> \n          {post.post_likeby.length === 0 && 'be the first one to like this post!'}\n          {post.post_likeby.length === 1 && `liked by ${post.post_likeby[0] === user.username ? 'you' : post.post_likeby[0] }`}\n          {post.post_likeby.length === 2 && `liked by ${post.post_likeby[0] === user.username ? 'you' : post.post_likeby[0] }, ${post.post_likeby[1] === user.username ? 'you' : post.post_likeby[1] }`}\n          {post.post_likeby.length > 2 && `liked by ${post.post_likeby[0] === user.username ? 'you' : post.post_likeby[0] }, ${post.post_likeby[1] === user.username ? 'you' : post.post_likeby[1] } and ${post.post_likeby.length - 2} others`}\n          </Typography>\n          <Typography className={classes.likes}><Link to={`/profile/${post.publisher_id}`} style={{color:'black'}}> {post.publisher_username} </Link> <span className=\"post-content\"> {post.post_content} </span></Typography> \n          <Divider className={classes.divider}/>\n          {post.post_comments.map(comment => (\n            <Typography  className={classes.comment}> \n            <Avatar><Image cloudName=\"malachcloud\" publicId={comment.commenter_profile} width=\"80\" /> </Avatar>\n            <Link to={`/profile/${comment.commenter_id}`} style={{color:'black'}}> <span className='commeter'>{comment.commenter} </span> </Link>\n            <span className=\"post-content\">{comment.content}</span>\n            </Typography>\n          ))}\n          <div className=\"post-date\">{post.post_date}</div>\n          <Divider className={classes.divider}/>\n          <TextField className={classes.AddCommenttextField} variant=\"outlined\" type=\"text\" label=\"Add a comment...\"\n          onChange={ e => setCommentValue(e.target.value)}\n          InputProps={{\n            startAdornment: (\n              <InputAdornment position=\"start\">\n                <IconButton> <MoodIcon/></IconButton>\n              </InputAdornment>\n            ),\n            endAdornment: (\n              <InputAdornment position=\"end\">\n                <Button onClick={() => sendComment(post.post_id, post.index)} color=\"primary\">Post</Button>\n              </InputAdornment>\n            ),\n          }}/>\n          </CardContent>\n        </Card>\n      </Grid>   \n       )):  <Loader /> }\n        <Hidden smDown>\n       <Grid item className={classes.suggestion} md={3}>\n       <div id=\"stepOne\"> <h6 className=\"user-suggested-headline\">Suggestions For You</h6> </div>\n         \n       {suggestionUsers && suggestionUsers.map(user => (\n        <div>\n        <CardHeader \n            avatar={ <Avatar><Image cloudName=\"malachcloud\" publicId={user.profile} width=\"70\" height=\"40\" crop=\"scale\" /> </Avatar>}\n            action={ <IconButton style={{marginRight:'10px'}} onClick={() => setFollow(user.id)}> <h6 className=\"user-suggested-follow\">Follow</h6> </IconButton> }\n            title={<Link to={`/profile/${user.id}`}><span className={classes.likes}>{user.username}</span></Link>}\n            subheader=\"New to Instagram\"\n            style={{width:'110%'}}\n          />\n           </div>\n       ))}\n       </Grid>\n       </Hidden>\n\n      {/* Fab */}\n      <Fab id=\"stepTwo\" color=\"primary\"  className={classes.fab} onClick={() => openModal()} title=\"Add new post\"> \n        <AddIcon />\n      </Fab>\n      {/* Share Modal */}\n   \n    \n       {/* Modal */}\n       <Modal size=\"lg\" centered show={emailModal} onHide={closeModal} style={{margin:'70px auto 30px' , maxHeight:'90%', overflowY:'auto'}}>\n                 <Modal.Header className={classes.modalHeader}> <Modal.Title style={{fontWeight:'700'}}> Add new post </Modal.Title> </Modal.Header>\n                 <Modal.Body>\n                 <Formik \n                   initialValues={{photo:'',content:''}}\n                   validationSchema={validationSchema}\n                   onSubmit={ editImage }>\n                    {({ errors, touched, setFieldValue }) => (\n                      <Form style={{textAlign:'center'}}>\n                      <Input id=\"file\" className=\"inputfile\" type=\"file\" name=\"photo\" onChange={(e) => handleChangeImage(e,setFieldValue )} hidden/> \n                    <Button className={classes.profileBtn} color='primary'  variant=\"outlined\"><ImageIcon className={classes.imageIcon}/><label htmlFor=\"file\">{fileName ? `${fileName} UPLOADED` : 'UPLPOAD IMAGE'} </label></Button>\n                      {errors.photo && touched.photo ?  <div className=\"error\">{errors.photo}</div>  : null}\n                      {previewSource ? \n                        <Card className={classes.previewcard}>\n                          <CardHeader avatar={ <Avatar><Image cloudName=\"malachcloud\" publicId={user.profile} width=\"80\" crop=\"scale\" /> </Avatar>} action={ <IconButton> <MoreVertIcon /> </IconButton> } title={<span className={classes.likes}>{user.username}</span>}/>\n                          <CardMedia className={classes.previewmedia} image={previewSource}></CardMedia>\n                          <CardActions disableSpacing>\n                            <IconButton className={classes.iconButton}> <FavoriteIcon style={{fill: \"red\"}}/> </IconButton>\n                            <IconButton> <ChatBubbleOutlineIcon/> </IconButton>\n                            <IconButton > <ShareIcon/> </IconButton>\n                          </CardActions>\n                       </Card>\n                      : null}\n                        <TextField  multiline rows={4} variant=\"outlined\" margin=\"normal\" fullWidth label=\"add description\" name=\"content\" onChange={(event) => setFieldValue(\"content\", event.target.value)}/>\n                        {errors.content && touched.content ?  <div className=\"error\">{errors.content}</div>  : null}\n                          {/* Alert error */}\n                        <Collapse in={openAlert}>\n                            <Alert \n                            style={{margin:'10px'}}\n                            severity={isBedAlert ? \"error\": \"success\"}\n                            action={ <IconButton color=\"inherit\" size=\"small\" onClick={() => setOpenAlert(false) }> <CloseIcon fontSize=\"inherit\" /> </IconButton>}>\n                            {message}\n                            </Alert>\n                          </Collapse>\n                        <Button  variant=\"outlined\" color=\"primary\" type=\"Submit\">Submit</Button>\n                      </Form>\n                    )}\n                  </Formik>\n                 </Modal.Body>\n            </Modal>\n      </Grid>\n       </StylesProvider>\n   \n    </>\n  )\n}\n\nexport default Home\n"]},"metadata":{},"sourceType":"module"}