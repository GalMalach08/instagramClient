{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/\\u05DE\\u05DC\\u05D0\\u05DA \\u05D2\\u05DC/Desktop/Projects/Instagram-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/\\u05DE\\u05DC\\u05D0\\u05DA \\u05D2\\u05DC/Desktop/Projects/Instagram-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/\\u05DE\\u05DC\\u05D0\\u05DA \\u05D2\\u05DC/Desktop/Projects/Instagram-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';// Formik\nimport{Formik,Form}from'formik';import*as Yup from'yup';// Cloudinary\nimport{Image}from'cloudinary-react';// material ui icons\nimport ShareIcon from'@material-ui/icons/Share';import MoreVertIcon from'@material-ui/icons/MoreVert';import ImageIcon from'@material-ui/icons/Image';import ChatBubbleOutlineIcon from'@material-ui/icons/ChatBubbleOutline';import CloseIcon from'@material-ui/icons/Close';import FavoriteIcon from'@material-ui/icons/Favorite';// Bootstrap\nimport Modal from'react-bootstrap/Modal';import{makeStyles}from'@material-ui/core/styles';import{Input,IconButton,Card,CardActions,CardHeader,CardMedia,Collapse,Avatar,TextField,Button}from'@material-ui/core';import Alert from'@material-ui/lab/Alert';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var useStyles=makeStyles(function(theme){return{root:{display:'flex',justifyContent:'center',marginTop:'30px'},previewcard:{width:'300px',height:'340px',margin:'auto'},media:{height:'550px',width:'550px',paddingTop:'56.25%'// 16:9\n},previewmedia:{width:'300px',height:'200px'},modalHeader:{display:'flex',justifyContent:'center',fontWeight:'bold'},imageIcon:{marginBottom:'8px',marginRight:'5px'}};});var StoryModal=function StoryModal(_ref){var storyModal=_ref.storyModal,setStoryModal=_ref.setStoryModal;var classes=useStyles();var _useState=useState(''),_useState2=_slicedToArray(_useState,2),fileName=_useState2[0],setFileName=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),previewSource=_useState4[0],setPreviewSource=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isProfile=_useState6[0],setIsProfile=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),openAlert=_useState8[0],setOpenAlert=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),isBedAlert=_useState10[0],setIsBedAlert=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),message=_useState12[0],setMessage=_useState12[1];var user=JSON.parse(localStorage.getItem('user'));var closeModal=function closeModal(){return setStoryModal(false);};// formik validation\nvar validationSchema=Yup.object().shape({photo:Yup.string().required('photo is required')});// Edit the profile image\nvar editImage=function editImage(values){values.fileName=fileName;if(typeof values.photo==='object'){var reader=new FileReader();reader.readAsDataURL(values.photo);reader.onloadend=function(){setPreviewSource(reader.result);values.photo=reader.result;addNewStory(values);};}else{addNewStory(values);}};// Add new Post\nvar addNewStory=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(values){var newStory,response,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:newStory={photo:values.photo,UserId:JSON.parse(localStorage.getItem('user')).id,fileName:values.fileName};_context.prev=1;_context.next=4;return fetch('/story',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(newStory)});case 4:response=_context.sent;_context.next=7;return response.json();case 7:data=_context.sent;if(data.story){setIsBedAlert(false);setMessage('Story Added');setOpenAlert(true);setTimeout(function(){closeModal();setOpenAlert(false);},1000);}else{setIsBedAlert(true);setMessage(data.error);setOpenAlert(true);}_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](1);console.error(_context.t0);case 14:case\"end\":return _context.stop();}}},_callee,null,[[1,11]]);}));return function addNewStory(_x){return _ref2.apply(this,arguments);};}();// Makes the preview image\nvar handleChangeImage=function handleChangeImage(e,setFieldValue){var reader=new FileReader();setFieldValue(\"photo\",e.target.files[0]);if(e.target.files.length===0){setIsProfile(false);setFileName('');setPreviewSource('');}else{reader.readAsDataURL(e.target.files[0]);reader.onloadend=function(){setPreviewSource(reader.result);};setIsProfile(true);setFileName(e.target.files[0].name);}};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Modal,{size:\"lg\",centered:true,show:storyModal,onHide:closeModal,children:[/*#__PURE__*/_jsxs(Modal.Header,{className:classes.modalHeader,children:[\" \",/*#__PURE__*/_jsx(Modal.Title,{style:{fontWeight:'700'},children:\" Add new story \"}),\" \"]}),/*#__PURE__*/_jsx(Modal.Body,{children:/*#__PURE__*/_jsx(Formik,{initialValues:{photo:'',content:''},validationSchema:validationSchema,onSubmit:editImage,children:function children(_ref3){var errors=_ref3.errors,touched=_ref3.touched,setFieldValue=_ref3.setFieldValue;return/*#__PURE__*/_jsxs(Form,{style:{textAlign:'center'},children:[/*#__PURE__*/_jsx(Input,{id:\"file\",className:\"inputfile\",type:\"file\",name:\"photo\",onChange:function onChange(e){return handleChangeImage(e,setFieldValue);},hidden:true}),/*#__PURE__*/_jsxs(Button,{className:classes.profileBtn,color:\"primary\",variant:\"outlined\",children:[/*#__PURE__*/_jsx(ImageIcon,{className:classes.imageIcon}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"file\",children:[fileName?\"\".concat(fileName,\" UPLOADED\"):'UPLPOAD IMAGE',\" \"]})]}),errors.photo&&touched.photo?/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:errors.photo}):null,/*#__PURE__*/_jsx(Collapse,{in:openAlert,children:/*#__PURE__*/_jsx(Alert,{style:{margin:'10px'},severity:isBedAlert?\"error\":\"success\",action:/*#__PURE__*/_jsxs(IconButton,{color:\"inherit\",size:\"small\",onClick:function onClick(){return setOpenAlert(false);},children:[\" \",/*#__PURE__*/_jsx(CloseIcon,{fontSize:\"inherit\"}),\" \"]}),children:message})}),/*#__PURE__*/_jsx(Button,{style:{margin:'10px'},variant:\"outlined\",color:\"primary\",type:\"Submit\",children:\"Submit\"})]});}})})]})});};export default StoryModal;","map":{"version":3,"sources":["C:/Users/מלאך גל/Desktop/Projects/Instagram-master/client/src/components/story/StoryModal.js"],"names":["React","useState","useEffect","Formik","Form","Yup","Image","ShareIcon","MoreVertIcon","ImageIcon","ChatBubbleOutlineIcon","CloseIcon","FavoriteIcon","Modal","makeStyles","Input","IconButton","Card","CardActions","CardHeader","CardMedia","Collapse","Avatar","TextField","Button","Alert","useStyles","theme","root","display","justifyContent","marginTop","previewcard","width","height","margin","media","paddingTop","previewmedia","modalHeader","fontWeight","imageIcon","marginBottom","marginRight","StoryModal","storyModal","setStoryModal","classes","fileName","setFileName","previewSource","setPreviewSource","isProfile","setIsProfile","openAlert","setOpenAlert","isBedAlert","setIsBedAlert","message","setMessage","user","JSON","parse","localStorage","getItem","closeModal","validationSchema","object","shape","photo","string","required","editImage","values","reader","FileReader","readAsDataURL","onloadend","result","addNewStory","newStory","UserId","id","fetch","method","headers","body","stringify","response","json","data","story","setTimeout","error","console","handleChangeImage","e","setFieldValue","target","files","length","name","content","errors","touched","textAlign","profileBtn"],"mappings":"umBAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA;AACA,OAASC,MAAT,CAAiBC,IAAjB,KAA4B,QAA5B,CACA,MAAO,GAAKC,CAAAA,GAAZ,KAAqB,KAArB,CACA;AACA,OAAQC,KAAR,KAAoB,kBAApB,CAEA;AACA,MAAOC,CAAAA,SAAP,KAAsB,0BAAtB,CACA,MAAOC,CAAAA,YAAP,KAAyB,6BAAzB,CACA,MAAOC,CAAAA,SAAP,KAAsB,0BAAtB,CACA,MAAOC,CAAAA,qBAAP,KAAkC,sCAAlC,CACA,MAAOC,CAAAA,SAAP,KAAsB,0BAAtB,CACA,MAAOC,CAAAA,YAAP,KAAyB,6BAAzB,CACA;AACA,MAAOC,CAAAA,KAAP,KAAkB,uBAAlB,CACA,OAASC,UAAT,KAA2B,0BAA3B,CACA,OAASC,KAAT,CAAgBC,UAAhB,CAA4BC,IAA5B,CAAkCC,WAAlC,CAA+CC,UAA/C,CAA2DC,SAA3D,CAAsEC,QAAtE,CAAgFC,MAAhF,CAAuFC,SAAvF,CAAkGC,MAAlG,KAAgH,mBAAhH,CACA,MAAOC,CAAAA,KAAP,KAAkB,wBAAlB,C,6IACA,GAAMC,CAAAA,SAAS,CAAGZ,UAAU,CAAC,SAACa,KAAD,QAAY,CACrCC,IAAI,CAAE,CACJC,OAAO,CAAC,MADJ,CAEJC,cAAc,CAAC,QAFX,CAGJC,SAAS,CAAC,MAHN,CAD+B,CAMrCC,WAAW,CAAC,CACVC,KAAK,CAAC,OADI,CAEVC,MAAM,CAAC,OAFG,CAGVC,MAAM,CAAC,MAHG,CANyB,CAWrCC,KAAK,CAAE,CACLF,MAAM,CAAE,OADH,CAELD,KAAK,CAAC,OAFD,CAGLI,UAAU,CAAE,QAAU;AAHjB,CAX8B,CAgBrCC,YAAY,CAAE,CACZL,KAAK,CAAC,OADM,CAEZC,MAAM,CAAC,OAFK,CAhBuB,CAoBrCK,WAAW,CAAE,CACZV,OAAO,CAAE,MADG,CAEZC,cAAc,CAAE,QAFJ,CAGZU,UAAU,CAAC,MAHC,CApBwB,CAyBrCC,SAAS,CAAE,CACPC,YAAY,CAAC,KADN,CAEPC,WAAW,CAAC,KAFL,CAzB0B,CAAZ,EAAD,CAA5B,CAiCA,GAAMC,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,MAAiC,IAA/BC,CAAAA,UAA+B,MAA/BA,UAA+B,CAAnBC,aAAmB,MAAnBA,aAAmB,CAChD,GAAMC,CAAAA,OAAO,CAAGrB,SAAS,EAAzB,CADgD,cAEhBzB,QAAQ,CAAC,EAAD,CAFQ,wCAEzC+C,QAFyC,eAE/BC,WAF+B,8BAGNhD,QAAQ,CAAC,EAAD,CAHF,yCAGzCiD,aAHyC,eAG1BC,gBAH0B,8BAIdlD,QAAQ,CAAC,KAAD,CAJM,yCAIzCmD,SAJyC,eAI9BC,YAJ8B,8BAKdpD,QAAQ,CAAC,KAAD,CALM,yCAKzCqD,SALyC,eAK9BC,YAL8B,8BAMZtD,QAAQ,CAAC,KAAD,CANI,0CAMzCuD,UANyC,gBAM7BC,aAN6B,gCAOlBxD,QAAQ,CAAC,EAAD,CAPU,2CAOzCyD,OAPyC,gBAOhCC,UAPgC,gBAQhD,GAAMC,CAAAA,IAAI,CAAGC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAX,CAAb,CAEA,GAAMC,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,SAAMnB,CAAAA,aAAa,CAAC,KAAD,CAAnB,EAAnB,CACC;AACD,GAAMoB,CAAAA,gBAAgB,CAAG7D,GAAG,CAAC8D,MAAJ,GAAaC,KAAb,CAAmB,CACxCC,KAAK,CAAChE,GAAG,CAACiE,MAAJ,GACLC,QADK,CACI,mBADJ,CADkC,CAAnB,CAAzB,CAKA;AACA,GAAMC,CAAAA,SAAS,CAAI,QAAbA,CAAAA,SAAa,CAACC,MAAD,CAAY,CAC3BA,MAAM,CAACzB,QAAP,CAAkBA,QAAlB,CACA,GAAG,MAAOyB,CAAAA,MAAM,CAACJ,KAAd,GAAwB,QAA3B,CAAsC,CACtC,GAAMK,CAAAA,MAAM,CAAG,GAAIC,CAAAA,UAAJ,EAAf,CACAD,MAAM,CAACE,aAAP,CAAqBH,MAAM,CAACJ,KAA5B,EACAK,MAAM,CAACG,SAAP,CAAmB,UAAM,CACzB1B,gBAAgB,CAACuB,MAAM,CAACI,MAAR,CAAhB,CACAL,MAAM,CAACJ,KAAP,CAAeK,MAAM,CAACI,MAAtB,CACAC,WAAW,CAACN,MAAD,CAAX,CACC,CAJD,CAKC,CARD,IAQO,CACHM,WAAW,CAACN,MAAD,CAAX,CACH,CACJ,CAbD,CAeE;AACJ,GAAMM,CAAAA,WAAW,2FAAG,iBAAON,MAAP,6IACZO,QADY,CACD,CACfX,KAAK,CAAEI,MAAM,CAACJ,KADC,CAEfY,MAAM,CAAGpB,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAX,EAAyCkB,EAFnC,CAGflC,QAAQ,CAAEyB,MAAM,CAACzB,QAHF,CADC,uCAOSmC,CAAAA,KAAK,CAAC,QAAD,CAAW,CACvCC,MAAM,CAAE,MAD+B,CAEvCC,OAAO,CAAE,CACL,eAAe,kBADV,CAF8B,CAKvCC,IAAI,CAAEzB,IAAI,CAAC0B,SAAL,CAAeP,QAAf,CALiC,CAAX,CAPd,QAORQ,QAPQ,qCAeGA,CAAAA,QAAQ,CAACC,IAAT,EAfH,QAeVC,IAfU,eAgBhB,GAAGA,IAAI,CAACC,KAAR,CAAc,CACZlC,aAAa,CAAC,KAAD,CAAb,CACAE,UAAU,CAAC,aAAD,CAAV,CACAJ,YAAY,CAAC,IAAD,CAAZ,CACAqC,UAAU,CAAC,UAAO,CACd3B,UAAU,GACVV,YAAY,CAAC,KAAD,CAAZ,CACH,CAHS,CAGR,IAHQ,CAAV,CAID,CARD,IAQO,CACLE,aAAa,CAAC,IAAD,CAAb,CACAE,UAAU,CAAC+B,IAAI,CAACG,KAAN,CAAV,CACAtC,YAAY,CAAC,IAAD,CAAZ,CACD,CA5Be,iFA+BduC,OAAO,CAACD,KAAR,cA/Bc,qEAAH,kBAAXd,CAAAA,WAAW,6CAAjB,CAmCK;AACA,GAAMgB,CAAAA,iBAAiB,CAAG,QAApBA,CAAAA,iBAAoB,CAACC,CAAD,CAAGC,aAAH,CAAqB,CAC9C,GAAMvB,CAAAA,MAAM,CAAG,GAAIC,CAAAA,UAAJ,EAAf,CACAsB,aAAa,CAAC,OAAD,CAAUD,CAAC,CAACE,MAAF,CAASC,KAAT,CAAe,CAAf,CAAV,CAAb,CACA,GAAGH,CAAC,CAACE,MAAF,CAASC,KAAT,CAAeC,MAAf,GAA0B,CAA7B,CAAgC,CAC9B/C,YAAY,CAAC,KAAD,CAAZ,CACAJ,WAAW,CAAC,EAAD,CAAX,CACAE,gBAAgB,CAAC,EAAD,CAAhB,CACD,CAJD,IAKK,CACHuB,MAAM,CAACE,aAAP,CAAqBoB,CAAC,CAACE,MAAF,CAASC,KAAT,CAAe,CAAf,CAArB,EACAzB,MAAM,CAACG,SAAP,CAAmB,UAAM,CACvB1B,gBAAgB,CAACuB,MAAM,CAACI,MAAR,CAAhB,CACD,CAFD,CAGAzB,YAAY,CAAC,IAAD,CAAZ,CACAJ,WAAW,CAAC+C,CAAC,CAACE,MAAF,CAASC,KAAT,CAAe,CAAf,EAAkBE,IAAnB,CAAX,CACD,CACF,CAhBA,CAkBH,mBACI,sCACO,MAAC,KAAD,EAAO,IAAI,CAAC,IAAZ,CAAiB,QAAQ,KAAzB,CAA0B,IAAI,CAAExD,UAAhC,CAA4C,MAAM,CAAEoB,UAApD,wBACE,MAAC,KAAD,CAAO,MAAP,EAAc,SAAS,CAAElB,OAAO,CAACR,WAAjC,4BAA+C,KAAC,KAAD,CAAO,KAAP,EAAa,KAAK,CAAE,CAACC,UAAU,CAAC,KAAZ,CAApB,6BAA/C,OADF,cAEE,KAAC,KAAD,CAAO,IAAP,wBACA,KAAC,MAAD,EACE,aAAa,CAAE,CAAC6B,KAAK,CAAC,EAAP,CAAUiC,OAAO,CAAC,EAAlB,CADjB,CAEE,gBAAgB,CAAEpC,gBAFpB,CAGE,QAAQ,CAAGM,SAHb,UAII,4BAAG+B,CAAAA,MAAH,OAAGA,MAAH,CAAWC,OAAX,OAAWA,OAAX,CAAoBP,aAApB,OAAoBA,aAApB,oBACC,MAAC,IAAD,EAAM,KAAK,CAAE,CAACQ,SAAS,CAAC,QAAX,CAAb,wBACA,KAAC,KAAD,EAAO,EAAE,CAAC,MAAV,CAAiB,SAAS,CAAC,WAA3B,CAAuC,IAAI,CAAC,MAA5C,CAAmD,IAAI,CAAC,OAAxD,CAAgE,QAAQ,CAAE,kBAACT,CAAD,QAAOD,CAAAA,iBAAiB,CAACC,CAAD,CAAGC,aAAH,CAAxB,EAA1E,CAAsH,MAAM,KAA5H,EADA,cAEE,MAAC,MAAD,EAAQ,SAAS,CAAElD,OAAO,CAAC2D,UAA3B,CAAuC,KAAK,CAAC,SAA7C,CAAwD,OAAO,CAAC,UAAhE,wBAA2E,KAAC,SAAD,EAAW,SAAS,CAAE3D,OAAO,CAACN,SAA9B,EAA3E,cAAqH,eAAO,OAAO,CAAC,MAAf,WAAuBO,QAAQ,WAAMA,QAAN,cAA4B,eAA3D,OAArH,GAFF,CAGCuD,MAAM,CAAClC,KAAP,EAAgBmC,OAAO,CAACnC,KAAxB,cAAiC,YAAK,SAAS,CAAC,OAAf,UAAwBkC,MAAM,CAAClC,KAA/B,EAAjC,CAAgF,IAHjF,cAIE,KAAC,QAAD,EAAU,EAAE,CAAEf,SAAd,uBACI,KAAC,KAAD,EACA,KAAK,CAAE,CAACnB,MAAM,CAAC,MAAR,CADP,CAEA,QAAQ,CAAEqB,UAAU,CAAG,OAAH,CAAY,SAFhC,CAGA,MAAM,cAAG,MAAC,UAAD,EAAY,KAAK,CAAC,SAAlB,CAA4B,IAAI,CAAC,OAAjC,CAAyC,OAAO,CAAE,yBAAMD,CAAAA,YAAY,CAAC,KAAD,CAAlB,EAAlD,4BAA+E,KAAC,SAAD,EAAW,QAAQ,CAAC,SAApB,EAA/E,OAHT,UAICG,OAJD,EADJ,EAJF,cAYE,KAAC,MAAD,EAAQ,KAAK,CAAE,CAACvB,MAAM,CAAC,MAAR,CAAf,CAAgC,OAAO,CAAC,UAAxC,CAAmD,KAAK,CAAC,SAAzD,CAAmE,IAAI,CAAC,QAAxE,oBAZF,GADD,EAJJ,EADA,EAFF,GADP,EADJ,CA8BH,CAtHD,CAwHA,cAAeS,CAAAA,UAAf","sourcesContent":["import React, { useState, useEffect } from 'react';\n// Formik\nimport { Formik, Form} from 'formik';\nimport * as Yup from 'yup';\n// Cloudinary\nimport {Image} from 'cloudinary-react';\n\n// material ui icons\nimport ShareIcon from '@material-ui/icons/Share';\nimport MoreVertIcon from '@material-ui/icons/MoreVert';\nimport ImageIcon from '@material-ui/icons/Image';\nimport ChatBubbleOutlineIcon from '@material-ui/icons/ChatBubbleOutline';\nimport CloseIcon from '@material-ui/icons/Close';\nimport FavoriteIcon from '@material-ui/icons/Favorite';\n// Bootstrap\nimport Modal from 'react-bootstrap/Modal'\nimport { makeStyles } from '@material-ui/core/styles';\nimport { Input, IconButton, Card, CardActions, CardHeader, CardMedia, Collapse, Avatar,TextField, Button } from '@material-ui/core';\nimport Alert from '@material-ui/lab/Alert';\nconst useStyles = makeStyles((theme) => ({\n    root: {\n      display:'flex',\n      justifyContent:'center',\n      marginTop:'30px'\n    },\n    previewcard:{\n      width:'300px',\n      height:'340px',\n      margin:'auto'\n    },\n    media: {\n      height: '550px',\n      width:'550px',\n      paddingTop: '56.25%', // 16:9\n    },\n    previewmedia: {\n      width:'300px',\n      height:'200px'\n    },\n    modalHeader: {\n     display: 'flex',\n     justifyContent: 'center',\n     fontWeight:'bold',\n    },\n    imageIcon: {\n        marginBottom:'8px',\n        marginRight:'5px'\n      },\n   \n  }))\n  \n\nconst StoryModal = ({storyModal, setStoryModal}) => {\n    const classes = useStyles()\n    const [fileName, setFileName] = useState('')\n    const [previewSource, setPreviewSource] = useState('')\n    const [isProfile, setIsProfile] = useState(false)\n    const [openAlert, setOpenAlert] = useState(false)\n    const [isBedAlert, setIsBedAlert] = useState(false)\n    const [message, setMessage] = useState('')\n    const user = JSON.parse(localStorage.getItem('user'))\n\n    const closeModal = () => setStoryModal(false)\n     // formik validation\n    const validationSchema = Yup.object().shape({\n        photo:Yup.string()\n        .required('photo is required')\n    })\n\n    // Edit the profile image\n    const editImage =  (values) => {\n        values.fileName = fileName\n        if(typeof values.photo === 'object' ) {\n        const reader = new FileReader()\n        reader.readAsDataURL(values.photo)\n        reader.onloadend = () => {\n        setPreviewSource(reader.result)\n        values.photo = reader.result\n        addNewStory(values)\n        }\n        } else {\n            addNewStory(values)\n        }\n    }\n\n      // Add new Post\n  const addNewStory = async (values) => {\n    const newStory = {\n      photo: values.photo,\n      UserId : JSON.parse(localStorage.getItem('user')).id,\n      fileName: values.fileName,\n    }\n      try {\n        const response = await fetch('/story', { \n        method: 'POST',\n        headers: {\n            'Content-Type':'application/json'\n        },\n        body: JSON.stringify(newStory)\n      })\n\n      const data = await response.json()\n      if(data.story){\n        setIsBedAlert(false)\n        setMessage('Story Added')\n        setOpenAlert(true)\n        setTimeout(() =>  {\n            closeModal()\n            setOpenAlert(false)\n        },1000)\n      } else {\n        setIsBedAlert(true)\n        setMessage(data.error)\n        setOpenAlert(true)\n      }\n\n    } catch (error) {\n        console.error(error)\n      }\n}\n\n       // Makes the preview image\n       const handleChangeImage = (e,setFieldValue) => {\n        const reader = new FileReader()\n        setFieldValue(\"photo\", e.target.files[0])\n        if(e.target.files.length === 0) {\n          setIsProfile(false)\n          setFileName('')\n          setPreviewSource('')\n        } \n        else {\n          reader.readAsDataURL(e.target.files[0])\n          reader.onloadend = () => {\n            setPreviewSource(reader.result)\n          }\n          setIsProfile(true)\n          setFileName(e.target.files[0].name)\n        }\n      }\n\n    return (\n        <>\n               <Modal size=\"lg\" centered show={storyModal} onHide={closeModal}>\n                 <Modal.Header className={classes.modalHeader}> <Modal.Title style={{fontWeight:'700'}}> Add new story </Modal.Title> </Modal.Header>\n                 <Modal.Body>\n                 <Formik \n                   initialValues={{photo:'',content:''}}\n                   validationSchema={validationSchema}\n                   onSubmit={ editImage }>\n                    {({ errors, touched, setFieldValue }) => (\n                      <Form style={{textAlign:'center'}}>\n                      <Input id=\"file\" className=\"inputfile\" type=\"file\" name=\"photo\" onChange={(e) => handleChangeImage(e,setFieldValue )} hidden/> \n                        <Button className={classes.profileBtn} color='primary'  variant=\"outlined\"><ImageIcon className={classes.imageIcon}/><label htmlFor=\"file\">{fileName ? `${fileName} UPLOADED` : 'UPLPOAD IMAGE'} </label></Button>\n                      {errors.photo && touched.photo ?  <div className=\"error\">{errors.photo}</div>  : null}\n                        <Collapse in={openAlert}>\n                            <Alert \n                            style={{margin:'10px'}}\n                            severity={isBedAlert ? \"error\": \"success\"}\n                            action={ <IconButton color=\"inherit\" size=\"small\" onClick={() => setOpenAlert(false) }> <CloseIcon fontSize=\"inherit\" /> </IconButton>}>\n                            {message}\n                            </Alert>\n                          </Collapse>\n                        <Button style={{margin:'10px'}} variant=\"outlined\" color=\"primary\" type=\"Submit\">Submit</Button>\n                      </Form>\n                    )}\n                  </Formik>\n                 </Modal.Body>\n            </Modal>\n        </>\n    )\n}\n\nexport default StoryModal\n"]},"metadata":{},"sourceType":"module"}